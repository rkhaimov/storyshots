"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5519],{7135:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"modules/msw","title":"@storyshots/msw-externals","description":"\u041f\u043e\u0434\u043c\u0435\u043d\u044f\u0435\u0442 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u043d\u0435 \u0438\u043d\u0432\u0430\u0437\u0438\u0432\u043d\u044b\u043c \u043c\u0435\u0442\u043e\u0434\u043e\u043c, \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e","source":"@site/docs/modules/msw.md","sourceDirName":"modules","slug":"/modules/msw","permalink":"/storyshots/modules/msw","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"defaultSidebar","previous":{"title":"@storyshots/arrangers","permalink":"/storyshots/modules/arrangers"},"next":{"title":"@storyshots/proxy","permalink":"/storyshots/modules/proxy"}}');var t=r(4848),a=r(8453);const o={sidebar_position:6},i="@storyshots/msw-externals",d={},l=[{value:"createWorkerSupplier",id:"createworkersupplier",level:2},{value:"Endpoints",id:"endpoints",level:2},{value:"MSWReplacer",id:"mswreplacer",level:2},{value:"createMSWArrangers",id:"createmswarrangers",level:2},{value:"endpoint",id:"endpoint",level:2},{value:"record",id:"record",level:2},{value:"handle",id:"handle",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"storyshotsmsw-externals",children:"@storyshots/msw-externals"})}),"\n",(0,t.jsxs)(n.p,{children:["\u041f\u043e\u0434\u043c\u0435\u043d\u044f\u0435\u0442 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443 ",(0,t.jsx)(n.a,{href:"/patterns/replace#%D0%BF%D0%BE%D0%B4%D0%BC%D0%B5%D0%BD%D0%B0-%D1%87%D0%B5%D1%80%D0%B5%D0%B7-%D1%81%D0%B0%D0%B9%D0%B4-%D1%8D%D1%84%D1%84%D0%B5%D0%BA%D1%82%D1%8B",children:"\u043d\u0435 \u0438\u043d\u0432\u0430\u0437\u0438\u0432\u043d\u044b\u043c \u043c\u0435\u0442\u043e\u0434\u043e\u043c"}),", \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e\n\u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 ",(0,t.jsx)(n.a,{href:"https://github.com/mswjs/msw",children:(0,t.jsx)(n.code,{children:"msw"})}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"createworkersupplier",children:"createWorkerSupplier"}),"\n",(0,t.jsx)(n.p,{children:"\u0414\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0444\u0430\u0439\u043b worker \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { ManagerConfig, mergeServe } from '@storyshots/core/manager';\nimport { createWorkerSupplier } from '@storyshots/msw-externals/createWorkerSupplier';\nimport { createWebpackServer } from '@storyshots/webpack';\n\nexport default {\n    preview: mergeServe(\n        createWorkerSupplier(),\n        // \u041c\u043e\u0436\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043b\u044e\u0431\u043e\u0439 \u0434\u0440\u0443\u0433\u043e\u0439 \u0441\u0435\u0440\u0432\u0435\u0440\n        createWebpackServer(/* ... */),\n    ),\n    /* ... */\n} satisfies ManagerConfig;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,t.jsx)(n.p,{children:"\u0425\u0440\u0430\u043d\u0438\u0442 \u043c\u0435\u0442\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u044b\u0445 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u0430\u0445:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { Endpoints } from '@storyshots/msw-externals'\n\ntype Externals = {\n    // \u041c\u0435\u0442\u0430 \u043e\u043f\u0438\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0432 \u043e\u0431\u0449\u0435\u043c \u0442\u0438\u043f\u0435 Endpoints \u0438 \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0432 externals.\n    endpoints: Endpoints;\n};\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u0432 ",(0,t.jsx)(n.code,{children:"preview"})," \u0437\u043e\u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0443\u0441\u0442\u043e\u0439 \u043e\u0431\u044a\u0435\u043a\u0442:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"export const { run, it, describe } = createPreviewApp<Externals>({\n    createExternals: () => ({ endpoints: {} as Endpoints }),\n    createJournalExternals: (externals) => externals,\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"mswreplacer",children:"MSWReplacer"}),"\n",(0,t.jsxs)(n.p,{children:["\u041f\u0435\u0440\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 API \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 ",(0,t.jsx)(n.code,{children:"Endpoints"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"void run(\n    map(stories, (story) => ({\n        render: (externals) => (\n            // MSWReplacer \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043d\u0441\u0442\u0430\u043d\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0440\u0430\u043d\u044c\u0448\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f\n            <MSWReplacer endpoints={externals.endpoints}>\n                <App />\n            </MSWReplacer>\n        ),\n        ...story,\n    })),\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"createmswarrangers",children:"createMSWArrangers"}),"\n",(0,t.jsxs)(n.p,{children:["\u0421\u043e\u0437\u0434\u0430\u0451\u0442 arrangers \u0443\u0442\u0438\u043b\u0438\u0442\u044b \u043d\u0430 \u0431\u0430\u0437\u0435 ",(0,t.jsx)(n.a,{href:"/modules/arrangers",children:(0,t.jsx)(n.code,{children:"@storyshots/arrangers"})}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import { createArrangers } from '@storyshots/arrangers';\nimport { createMSWArrangers, Endpoints } from '@storyshots/msw-externals';\n\nconst arrangers = createArrangers<Endpoints>();\n\nconst msw = createMSWArrangers(\n    // \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u043f\u0443\u0442\u044c \u0434\u043e \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f Endpoints \u0432 externals\n    arrangers.focus('endpoints')\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"endpoint",children:"endpoint"}),"\n",(0,t.jsx)(n.p,{children:"\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u043d\u043e\u0432\u044b\u0439 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442 \u0432 \u043c\u0435\u0442\u0443:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"it('...', {\n    arrange: endpoint('findPetsByStatus', {\n        url: '/api/pet/findByStatus',\n        handle: () => [],\n    })\n});\n\ndeclare module '@storyshots/msw-externals' {\n    // \u041f\u043e\u043c\u0438\u043c\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0442\u0438\u043f\n    interface Endpoints {\n        findPetsByStatus: Endpoint<FindPetsByStatusApiResponse>;\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsxs)(n.p,{children:["\u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f ",(0,t.jsx)(n.code,{children:"endpoint"})," \u043c\u043e\u0436\u043d\u043e \u0432\u044b\u043d\u0435\u0441\u0442\u0438 \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u0443\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u044e:"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"it('...', {\n    arrange: setup()\n});\n\nfunction setup() {\n    return endpoint('findPetsByStatus', {\n        url: '/api/pet/findByStatus',\n        handle: () => [],\n    });\n}\n\ndeclare module '@storyshots/msw-externals' {\n    // \u041f\u043e\u043c\u0438\u043c\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0430\u0443\u0433\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0442\u0438\u043f\n    interface Endpoints {\n        findPetsByStatus: Endpoint<FindPetsByStatusApiResponse>;\n    }\n}\n"})})]}),"\n",(0,t.jsx)(n.h2,{id:"record",children:"record"}),"\n",(0,t.jsx)(n.p,{children:"\u0414\u0435\u043b\u0430\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0435 \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u043c\u0438:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"it('...', {\n    arrange: arrange(\n        setup(),\n        // \u0412\u044b\u0437\u043e\u0432\u044b findPetsByStatus \u0442\u0435\u043f\u0435\u0440\u044c \u0431\u0443\u0434\u0443\u0442 \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u044b \u0432 \u0436\u0443\u0440\u043d\u0430\u043b\n        record('findPetsByStatus'),\n    )\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"handle",children:"handle"}),"\n",(0,t.jsx)(n.p,{children:"\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u043e\u0434\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u044d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u0430:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"it('...', {\n    arrange: arrange(\n        setup(),\n        // \u041f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 findPetsByStatus \u0442\u0435\u043f\u0435\u0440\u044c \u0434\u0440\u0443\u0433\u043e\u0435\n        handle('findPetsByStatus', () => createFewPetsStub()),\n    )\n});\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"tip",children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"endpoint"}),", ",(0,t.jsx)(n.code,{children:"record"})," \u0438 ",(0,t.jsx)(n.code,{children:"handle"})," \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0442\u0430\u043a\u0438\u043c\u0438 \u0436\u0435 \u0443\u0442\u0438\u043b\u0438\u0442\u0430\u043c\u0438 arrangers \u0447\u0442\u043e \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0435 \u0432 ",(0,t.jsx)(n.code,{children:"@storyshots/arrangers"}),"."]}),(0,t.jsx)(n.p,{children:"\u0414\u043b\u044f \u043d\u0438\u0445 \u0440\u0430\u0431\u043e\u0442\u0430\u044e\u0442 \u0442\u0435 \u0436\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u0438 \u0438\u0445 \u0441\u043f\u043e\u043a\u043e\u0439\u043d\u043e \u043c\u043e\u0436\u043d\u043e \u043a\u043e\u043c\u0431\u0438\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u0435\u0436\u0434\u0443 \u0441\u043e\u0431\u043e\u0439."})]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var s=r(6540);const t={},a=s.createContext(t);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);